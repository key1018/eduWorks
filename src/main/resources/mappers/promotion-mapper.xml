<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="promotionMapper">
	<resultMap id="promotionResult" type="Promotion">
		<result column="promo_no" property="promoNo" />
		<result column="promo_title" property="promoTitle" />
		<result column="promo_cate_no" property="promoCateNo" />
		<result column="promo_writer" property="promoWriter" />
		<result column="promo_content" property="promoContent" />
		<result column="promo_create_date" property="promoCreateDate" />
	</resultMap>
	
	<select id="selectListCount" resultType="_int">
		select count(*)
		  from tb_promo
		 where promo_status = 'Y'
		 <if test="no != null">
		 	and promo_cate_no = #{no}
		 </if>
		 <if test="keyword != null">
		 	and promo_title like '%' || #{keyword} || '%'
		     or promo_writer like '%' || #{keyword} || '%'
		 </if>
	</select>
	
	<select id="selectPromoList" resultMap="promotionResult">
		select promo_no
			 , promo_title
			 , promo_cate_no
			 , promo_writer
			 , to_char(promo_create_date, 'YYYY-MM-DD') as "promo_create_date"
		  from tb_promo
		 where promo_status = 'Y'
		   <if test="no != null">
		 		and promo_cate_no = #{no}
		   </if>
		   <if test="keyword != null">
		      and promo_title like '%' || #{keyword} || '%'
		       or promo_writer like '%' || #{keyword} || '%'
		   </if>
		 order
		    by promo_no desc
	</select>
	
	<insert id="insertPromo">
		insert
		  into tb_promo
		  (
		    promo_no
		  , promo_title
		  , promo_cate_no
		  , promo_writer
		  , promo_content
		  )
		  values
		  (
		    seq_prno.nextval
		  , #{promoTitle}
		  , #{promoCateNo}
		  , #{promoWriter}
		  , #{promoContent}
		  )
	</insert>
  
</mapper>
